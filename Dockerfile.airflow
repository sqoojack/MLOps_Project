FROM apache/airflow:2.8.1-python3.10

# 切換到 root 安裝系統依賴 (如果需要 git 或其他工具)
USER root
RUN apt-get update && \
    apt-get install -y git && \
    apt-get clean

# 切換回 airflow 使用者安裝 Python 套件
USER airflow

# 複製 requirements.txt
COPY requirements.txt /requirements.txt

# 安裝專案依賴 (包含 dvc, torch, pandas 等)
RUN pip install --no-cache-dir -r /requirements.txt